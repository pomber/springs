<script>
  import BigChart from "./big-chart.svelte";
  import SmallChart from "./small-chart.svelte";
  import Border from "./border.svelte";
  import Slider from "./slider.svelte";
  import Spring from "./spring.svelte";

  let k1 = 16;
  let c1 = 20;
  let m1 = 15;

  let k2 = 26;
  let c2 = 22;
  let m2 = 20;

  let k3 = 36;
  let c3 = 31;
  let m3 = 33;

  let resolution = 250;
  let x0 = 1;
  let maxt = 6;

  $: springs = [
    { k: k1, c: c1, m: m1, color: "blue" },
    { k: k2, c: c2, m: m2, color: "red" },
    { k: k3, c: c3, m: m3, color: "green" }
  ];

  const multiplier = 2;

  $: lks = springs.map(s => ({ ...s, k: s.k / multiplier }));
  $: lcs = springs.map(s => ({ ...s, c: s.c / multiplier }));
  $: lms = springs.map(s => ({ ...s, m: s.m / multiplier }));
  $: mks = springs.map(s => ({ ...s, k: s.k * multiplier }));
  $: mcs = springs.map(s => ({ ...s, c: s.c * multiplier }));
  $: mms = springs.map(s => ({ ...s, m: s.m * multiplier }));
</script>

<style>
  h1 {
    text-align: center;
  }
  header,
  footer {
    flex: 1;
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    grid-template-rows: repeat(5, 1fr);
    grid-column-gap: 10px;
    grid-row-gap: 10px;
    max-width: 1200px;
  }
  .center {
    grid-area: 2 / 2 / 5 / 5;
  }
  .right-panel {
    grid-area: 1 / 5 / 6 / 6;
    padding: 20px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .left-panel {
    grid-area: 1 / 1 / 6 / 2;
    padding: 10px;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  .top1 {
    grid-area: 1 / 2 / 2 / 3;
  }
  .top2 {
    grid-area: 1 / 3 / 2 / 4;
  }
  .top3 {
    grid-area: 1 / 4 / 2 / 5;
  }
  .bottom1 {
    grid-area: 5 / 2 / 6 / 3;
  }
  .bottom2 {
    grid-area: 5 / 3 / 6 / 4;
  }
  .bottom3 {
    grid-area: 5 / 4 / 6 / 5;
  }
  .spring-controls {
    padding: 10px;
  }
  .spring-controls.blue {
    /* background: radial-gradient(ellipse at center, #27eed320 0%, #27eed310 80%); */
    /* box-shadow: inset 0px 0px 7px #27eed3; */
  }
  .spring-controls.red {
    /* background: radial-gradient(ellipse at center, #f1993a20 0%, #f1993a10 80%); */
    /* box-shadow: inset 0px 0px 7px #f1993a; */
  }
  .spring-controls.green {
    /* background: radial-gradient(ellipse at center, #87c33d20 0%, #87c33d10 80%); */
    /* box-shadow: inset 0px 0px 7px #87c33d; */
  }
</style>

<header>
  <h1>Springs</h1>
</header>
<div class="grid">
  <div class="center">
    <BigChart {springs} {resolution} {maxt} />
  </div>
  <div class="right-panel">

    <div class="spring-controls">
      <Slider min={1} max={10} bind:value={maxt} label="T" />
    </div>
    <div class="spring-controls blue">
      <Slider bind:value={k1} label="Stiffness" />
      <Slider bind:value={c1} label="Damping" />
      <Slider bind:value={m1} label="Mass" />
    </div>
    <div class="spring-controls red">
      <Slider bind:value={k2} label="Stiffness" />
      <Slider bind:value={c2} label="Damping" />
      <Slider bind:value={m2} label="Mass" />
    </div>
    <div class="spring-controls green">
      <Slider bind:value={k3} label="Stiffness" />
      <Slider bind:value={c3} label="Damping" />
      <Slider bind:value={m3} label="Mass" />
    </div>
  </div>
  <div class="left-panel">
    Resolution
    <Slider min={10} max={2000} bind:value={resolution} />
    T
  </div>
  <div class="top1">
    <SmallChart springs={lks} {resolution} {maxt} label="- stiffness" />
  </div>
  <div class="top2">
    <SmallChart springs={lcs} {resolution} {maxt} label="- damping" />
  </div>
  <div class="top3">
    <SmallChart springs={lms} {resolution} {maxt} label="- mass" />
  </div>
  <div class="bottom1">
    <SmallChart springs={mks} {resolution} {maxt} label="+ stiffness" />
  </div>
  <div class="bottom2">
    <SmallChart springs={mcs} {resolution} {maxt} label="+ damping" />
  </div>
  <div class="bottom3">
    <SmallChart springs={mms} {resolution} {maxt} label="+ mass" />
  </div>
</div>
<footer />
